# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/leds/leds-qcom-lpg.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Qualcomm Light Pulse Generator

maintainers:
  - Bjorn Andersson <bjorn.andersson@linaro.org>

description: >
  The Qualcomm Light Pulse Generator consists of three different hardware blocks;
  a ramp generator with lookup table, the light pulse generator and a three
  channel current sink. These blocks are found in a wide range of Qualcomm PMICs.

properties:
  compatible:
    enum:
      - qcom,pm8916-pwm
      - qcom,pm8941-lpg
      - qcom,pm8994-lpg
      - qcom,pmi8994-lpg
      - qcom,pmi8998-lpg

  "#pwm-cells":
    const: 2

  "#address-cells":
    const: 1

  "#size-cells":
    const: 0

  qcom,power-source:
    $ref: /schemas/types.yaml#definitions/uint32
    description: >
      power-source used to drive the output, as defined in the datasheet.
      Should be specified if the TRILED block is present
    enum:
      - 0
      - 1
      - 3

  multi-led:
    type: object
    $ref: leds-class-multicolor.yaml#
    properties:
      "#address-cells":
        const: 1

      "#size-cells":
        const: 0

      "^led@[0-9a-f]$":
        type: object
        $ref: common.yaml#

        properties:
          "qcom,dtest":
            $ref: /schemas/types.yaml#definitions/uint32-array
            description: >
              configures the output into an internal test line of the pmic. Specified
              by a list of u32 pairs, one pair per channel, where each pair denotes the
              test line to drive and the second configures how the value should be
              outputed, as defined in the datasheet
            minItems: 2
            maxItems: 2

        required:
          - reg

patternProperties:
  "^led@[0-9a-f]$":
    type: object
    $ref: common.yaml#
    properties:
      "qcom,dtest":
        $ref: /schemas/types.yaml#definitions/uint32-array
        description: >
          configures the output into an internal test line of the pmic. Specified
          by a list of u32 pairs, one pair per channel, where each pair denotes the
          test line to drive and the second configures how the value should be
          outputed, as defined in the datasheet
        minItems: 2
        maxItems: 2

    required:
      - reg

required:
  - compatible

additionalProperties: false

examples:
  - |
    #include <dt-bindings/leds/common.h>

    lpg {
      compatible = "qcom,pmi8994-lpg";

      #address-cells = <1>;
      #size-cells = <0>;

      qcom,power-source = <1>;

      led@1 {
        reg = <1>;
        label = "green:user1";
      };

      led@2 {
        reg = <2>;
        label = "green:user0";
        default-state = "on";
      };

      led@3 {
        reg = <3>;
        label = "green:user2";
      };

      led@4 {
        reg = <4>;
        label = "green:user3";

        qcom,dtest = <4 1>;
      };
    };
  - |
    #include <dt-bindings/leds/common.h>

    lpg {
      compatible = "qcom,pmi8994-lpg";

      #address-cells = <1>;
      #size-cells = <0>;

      qcom,power-source = <1>;

      multi-led {
        color = <LED_COLOR_ID_MULTI>;
        label = "rgb:notification";

        #address-cells = <1>;
        #size-cells = <0>;

        led@1 {
          reg = <1>;
          color = <LED_COLOR_ID_RED>;
        };

        led@2 {
          reg = <2>;
          color = <LED_COLOR_ID_GREEN>;
        };

        led@3 {
          reg = <3>;
          color = <LED_COLOR_ID_BLUE>;
        };
      };
    };
  - |
    lpg {
      compatible = "qcom,pm8916-pwm";
      #pwm-cells = <2>;
    };
...
